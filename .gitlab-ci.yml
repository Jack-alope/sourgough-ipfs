image: registry.gitlab.com/pages/hugo:latest

variables:
  GIT_SUBMODULE_STRATEGY: recursive

pages:
  script:
    - apk add --update git nodejs npm
    - npm install --save request request-promise cheerio puppeteer
    - mkdir themes
    - cd themes
    - git clone https://github.com/Jack-alope/sourgough-starter.git
    - cd ..
    - node static/js/scholar-stats.js
    - hugo
  artifacts:
    paths:
      - public
  only:
    - main
